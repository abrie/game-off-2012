<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>test</title>

	<link href="styles.css" rel="stylesheet" type="text/css" />
	<script>
		var createjs = window;
	</script>
	<script type="text/javascript" src="lib/easeljs-0.5.0.min.js"></script>

	<script>
	var KEYCODE_step1 = 76;
	var KEYCODE_step2 = 75
	var KEYCODE_step3 = 74;
	var KEYCODE_step4 = 72;
	var KEYCODE_SPACE = 32;

	function handleKeyDown(e) {
		//cross browser issues exist, says EaselJS
		if(!e){ var e = window.event; }
		switch(e.keyCode) {
			case KEYCODE_step1: impelPlayer(1); return false;
			case KEYCODE_step2: impelPlayer(1.5); return false; 
			case KEYCODE_step3: impelPlayer(2.0); return false; 
			case KEYCODE_step4: impelPlayer(2.5); return false; 
			case KEYCODE_SPACE:	turnClockwise(); return false;
		}
	}

	var playerImage = undefined;
	var player = {pX:100,pY:100,vX:0,vY:0}
	function initPlayer() {
		playerImage = new Shape();
		playerImage.graphics.beginFill("red").drawCircle(0, 0, 10);
		playerImage.x = 100;
		playerImage.y = 100;
		stage.addChild(playerImage);
	}

	function impelPlayer(val) {
		switch(dir) {
			case 0: player.vX+=val*1; break;
			case 1: player.vY+=val*1; break;
			case 2: player.vX-=val*1; break;
			case 3: player.vY-=val*1; break;
		}
	}

	var dir = 0;
	function turnClockwise() {
		dir = dir >= 3 ? 0 : dir+1;
	}

	var stage = undefined;
	function init() {
		document.onkeydown = handleKeyDown;
		var canvas = document.getElementById("testCanvas");

		stage = new Stage(canvas);
		initPlayer();

		stage.update();
		Ticker.setFPS(20);
		Ticker.useRAF = true;
		Ticker.addListener(window);
	}

	function tickPlayer(elapsedTime) {
		if( player.vX > 0 ) {
			player.vX-=0.5;
		}
		if( player.vX < 0 ) {
			player.vX+=0.5;
		}
		if( player.vY > 0 ) {
			player.vY-=0.5;
		}
		if( player.vY < 0 ) {
			player.vY+=0.5;
		}
	}

	function tick(elapsedTime) {
		// time based
		playerImage.x = playerImage.x + Math.ceil( player.vX*elapsedTime/1000*10 );
		playerImage.y = playerImage.y + Math.ceil( player.vY*elapsedTime/1000*10 );
		if (playerImage.x > stage.canvas.width) { playerImage.x = 0; }
		tickPlayer(elapsedTime);
		stage.update();
	}
	</script>
</head>
	
<body onload="init();">

	<header id="header" class="EaselJS">
		just playin'
	</header>

	<div class="canvasHolder">
		<canvas id="testCanvas" width="960" height="400"></canvas>
	</div>
</body>
</html>
